# 料理画像から栄養素を予測するAIアプリ

## 【概要】
このアプリは、料理画像をアップロードし、**カロリー・たんぱく質・脂質・炭水化物・塩分**の5つの栄養素をAIが予測します。  
画像処理とディープラーニング、FlaskによるWebアプリケーション、ログイン機能、ワンタイムパスワード認証機能を組み合わせています。

---

## 【使用方法】
1. 登録画面からメールアドレスとパスワードを入力して新規登録  
2. 登録した情報でログイン  
3. 「ワンタイムパスワードを入力する」ボタンを押す  
4. メールで受信したワンタイムパスワードを入力して確認  
5. 「ファイルを選択」で料理画像をアップロード  
6. 「栄養予測を実行」で結果表示  

---

## 【特徴と技術構成】

### 1. AIによる栄養素予測
- CNN（畳み込みニューラルネットワーク）による画像回帰モデル（TensorFlow / Keras）
- 予測対象：カロリー・たんぱく質・脂質・炭水化物・塩分
- データ拡張：左右反転・回転・明るさ変更で学習データ多様化
- 精度評価：平均絶対誤差（MAE）を指標に評価

### 2. Webアプリケーション（Flask）
- メールアドレスとパスワードによるユーザー登録・ログイン
- ワンタイムパスワードによる二段階認証
- 料理画像アップロード→栄養素予測→結果表示

### 3. セキュリティ
- `Flask-Login` によるログインセッション管理
- `Flask-Mail + pyotp` によるメールベースのワンタイムパスワード認証

---

## 【ディレクトリ構成】
```markdown
Judge_CookImage/
├── data/
│   ├── images/                   #元画像
│   ├── augmented_images/images/  #拡張画像
│   ├── uploads/                  #アップロードされた画像
│   ├── nutrition_model.keras     #学習済みモデル
│   └── nutrition.csv             # 栄養素CSVデータ
│
├── templates/
│   ├── login.html                #ログイン画面
│   ├── register.html             #ユーザー登録画面
│   ├── otp_sent.html             #ワンタイムパスワード送信確認画面
│   └── verify.html               #ワンタイムパスワード入力画面
│
├── augment_images.py            #画像拡張コード
├── filename.py                  #画像ファイル名一覧CSV生成コード
├── nutrition_model.py           #モデル学習コード
├── cook_flask.py                #アプリ実行コード
└── requirements.txt             #必要なライブラリ一覧
```


---

## 【工夫したポイント】

1. **セキュリティ強化**：パスワード＋ワンタイムパスワードによる二段階認証を導入  
2. **モバイル対応**：スマホ画面でも使いやすいようにフォントサイズを調整  
3. **セッション安定化**：ワンタイムパスワード送信後に画面描画を挟み、セッション保持の安定性を向上  
4. **データ増強**：画像の反転・回転・明度変化により学習の多様性を確保  

---

## 【使用ライブラリ】

- Flask / Flask-SQLAlchemy / Flask-Mail / Flask-Login  
- TensorFlow / Keras  
- numpy / pandas / scikit-learn / pillow / pyotp  
- gunicorn（本番デプロイ用）  

---

## 【想定ユースケース】
- 食生活改善をしたい人
- 栄養バランスを手軽に可視化したい人
